# DUPTester

- ./src: The scripts to run stressing or unit upgrade test for all systems to reproduce bugs.
- ./systems: Files required to build images of different versions of each systems.
- ./dataVerify: Script and cases info to verify data we write in paper.
- ./tests: Directory used to store the data and logs  generated by tests.
- ./test-migrator-based-python: Script to mirgrate Cassandra unit tests from Java to Python, and generate upgrade tests for each unit test.


# Requirements:
1. Java >= 1.8 (OpenJDK and Oracle JVMS have been tested)
2. Python 3.6+


# Getting started:
1. Set up DUPTester:
    Run script to install dependencies, and checkout required applications.
   	bash DUPTester-setup.sh

2. Run script to verify data
cd submit/dataVerify
python3 dataVerfication.py

3. Run scripts to reproduce bugs found by our upgrade test tool.
    # Prepare:
        a. Checkout the required applications.
	    Cassandra: git clone https://github.com/apache/cassandra
	    Hbase: git clone https://github.com/apache/hbase
	    Hive: git clone https://github.com/apache/hive
	    Kafka: git clone https://github.com/apache/kafka
	    Zookeeper: git clone https://github.com/apache/zookeeper
	    Hdfs: git clone https://github.com/apache/hadoop
	b. Setup configuration to build image for each application and version.
	    Add application source code location to submit/applicationName/applicationName.srclocation.
	c. Install dependencies
	    pip3 install docker numpy pandas

    #Run Script
	cd submit/src
	python3 reproduce_upgrade_bugs.py

4. Run script to migrate unit test for Cassandra.
    #Prepare:
	a. Copy the unit test java file to submit/test-migrator-based-python/java_files.
	   Cassandra unit test is located at: cassandra/test/unit/org/apache/cassandra/
	b. Modify upgrade test configuration in submit/test-migrator-based-python/base_file.py
	c. Install dependencies:
	    pip3 install astunparse cassandra-driver javalang

    #Run Script:
	cd submit/test-migrator-based-python
	python3 multiple_tests_generator.py

	The migrated tests are saved in submit/test-migrator-based-python/migrate_result
 	The generated upgrade tests are saved in submit/src/cass/generated_test
