SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/hive/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/hadoop/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Metastore connection URL:	 jdbc:derby:;databaseName=/hive/data/metastore_db;create=true
Metastore Connection Driver :	 org.apache.derby.jdbc.EmbeddedDriver
Metastore connection User:	 APP
Starting metastore schema initialization to 2.3.0
Initialization script hive-schema-2.3.0.derby.sql
Connecting to jdbc:derby:;databaseName=/hive/data/metastore_db;create=true
Connected to: Apache Derby (version 10.10.2.0 - (1582446))
Driver: Apache Derby Embedded JDBC Driver (version 10.10.2.0 - (1582446))
Transaction isolation: TRANSACTION_READ_COMMITTED
0: jdbc:derby:> !autocommit on
Autocommit status: true
0: jdbc:derby:> CREATE FUNCTION "APP"."NUCLEUS_ASCII" (C CHAR(1)) RETURNS INTEGE R LANGUAGE JAVA PARAMETER STYLE JAVA READS SQL DATA CALLED ON NULL INPUT EXTERNA L NAME 'org.datanucleus.store.rdbms.adapter.DerbySQLFunction.ascii' 
No rows affected (0.273 seconds)
0: jdbc:derby:> CREATE FUNCTION "APP"."NUCLEUS_MATCHES" (TEXT VARCHAR(8000),PATT ERN VARCHAR(8000)) RETURNS INTEGER LANGUAGE JAVA PARAMETER STYLE JAVA READS SQL  DATA CALLED ON NULL INPUT EXTERNAL NAME 'org.datanucleus.store.rdbms.adapter.Der bySQLFunction.matches' 
0: jdbc:derby:> No rows affected (0.026 seconds)
CREATE TABLE "APP"."DBS" ("DB_ID" BIGINT NOT NULL, "DESC" VARCHA R(4000), "DB_LOCATION_URI" VARCHAR(4000) NOT NULL, "NAME" VARCHAR(128), "OWNER_N AME" VARCHAR(128), "OWNER_TYPE" VARCHAR(10))
No rows affected (0.134 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."TBL_PRIVS" ("TBL_GRANT_ID" BIGINT NOT NULL,  "CREATE_TIME" INTEGER NOT NULL, "GRANT_OPTION" SMALLINT NOT NULL, "GRANTOR" VARC HAR(128), "GRANTOR_TYPE" VARCHAR(128), "PRINCIPAL_NAME" VARCHAR(128), "PRINCIPAL _TYPE" VARCHAR(128), "TBL_PRIV" VARCHAR(128), "TBL_ID" BIGINT)
No rows affected (0.121 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."DATABASE_PARAMS" ("DB_ID" BIGINT NOT NULL, " PARAM_KEY" VARCHAR(180) NOT NULL, "PARAM_VALUE" VARCHAR(4000))
No rows affected (0.098 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."TBL_COL_PRIVS" ("TBL_COLUMN_GRANT_ID" BIGINT  NOT NULL, "COLUMN_NAME" VARCHAR(767), "CREATE_TIME" INTEGER NOT NULL, "GRANT_OP TION" SMALLINT NOT NULL, "GRANTOR" VARCHAR(128), "GRANTOR_TYPE" VARCHAR(128), "P RINCIPAL_NAME" VARCHAR(128), "PRINCIPAL_TYPE" VARCHAR(128), "TBL_COL_PRIV" VARCH AR(128), "TBL_ID" BIGINT)
No rows affected (0.099 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."SERDE_PARAMS" ("SERDE_ID" BIGINT NOT NULL, " PARAM_KEY" VARCHAR(256) NOT NULL, "PARAM_VALUE" CLOB)
No rows affected (0.099 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."COLUMNS_V2" ("CD_ID" BIGINT NOT NULL, "COMME NT" VARCHAR(4000), "COLUMN_NAME" VARCHAR(767) NOT NULL, "TYPE_NAME" CLOB, "INTEG ER_IDX" INTEGER NOT NULL)
No rows affected (0.107 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."SORT_COLS" ("SD_ID" BIGINT NOT NULL, "COLUMN _NAME" VARCHAR(767), "ORDER" INTEGER NOT NULL, "INTEGER_IDX" INTEGER NOT NULL)
No rows affected (0.096 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."CDS" ("CD_ID" BIGINT NOT NULL)
No rows affected (0.091 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."PARTITION_KEY_VALS" ("PART_ID" BIGINT NOT NU LL, "PART_KEY_VAL" VARCHAR(256), "INTEGER_IDX" INTEGER NOT NULL)
No rows affected (0.09 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."DB_PRIVS" ("DB_GRANT_ID" BIGINT NOT NULL, "C REATE_TIME" INTEGER NOT NULL, "DB_ID" BIGINT, "GRANT_OPTION" SMALLINT NOT NULL,  "GRANTOR" VARCHAR(128), "GRANTOR_TYPE" VARCHAR(128), "PRINCIPAL_NAME" VARCHAR(12 8), "PRINCIPAL_TYPE" VARCHAR(128), "DB_PRIV" VARCHAR(128))
No rows affected (0.089 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."IDXS" ("INDEX_ID" BIGINT NOT NULL, "CREATE_T IME" INTEGER NOT NULL, "DEFERRED_REBUILD" CHAR(1) NOT NULL, "INDEX_HANDLER_CLASS " VARCHAR(4000), "INDEX_NAME" VARCHAR(128), "INDEX_TBL_ID" BIGINT, "LAST_ACCESS_ TIME" INTEGER NOT NULL, "ORIG_TBL_ID" BIGINT, "SD_ID" BIGINT)
No rows affected (0.1 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."INDEX_PARAMS" ("INDEX_ID" BIGINT NOT NULL, " PARAM_KEY" VARCHAR(256) NOT NULL, "PARAM_VALUE" VARCHAR(4000))
No rows affected (0.105 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."PARTITIONS" ("PART_ID" BIGINT NOT NULL, "CRE ATE_TIME" INTEGER NOT NULL, "LAST_ACCESS_TIME" INTEGER NOT NULL, "PART_NAME" VAR CHAR(767), "SD_ID" BIGINT, "TBL_ID" BIGINT)
No rows affected (0.093 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."SERDES" ("SERDE_ID" BIGINT NOT NULL, "NAME"  VARCHAR(128), "SLIB" VARCHAR(4000))
No rows affected (0.083 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."PART_PRIVS" ("PART_GRANT_ID" BIGINT NOT NULL , "CREATE_TIME" INTEGER NOT NULL, "GRANT_OPTION" SMALLINT NOT NULL, "GRANTOR" VA RCHAR(128), "GRANTOR_TYPE" VARCHAR(128), "PART_ID" BIGINT, "PRINCIPAL_NAME" VARC HAR(128), "PRINCIPAL_TYPE" VARCHAR(128), "PART_PRIV" VARCHAR(128))
No rows affected (0.115 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."ROLE_MAP" ("ROLE_GRANT_ID" BIGINT NOT NULL,  "ADD_TIME" INTEGER NOT NULL, "GRANT_OPTION" SMALLINT NOT NULL, "GRANTOR" VARCHAR (128), "GRANTOR_TYPE" VARCHAR(128), "PRINCIPAL_NAME" VARCHAR(128), "PRINCIPAL_TY PE" VARCHAR(128), "ROLE_ID" BIGINT)
No rows affected (0.102 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."TYPES" ("TYPES_ID" BIGINT NOT NULL, "TYPE_NA ME" VARCHAR(128), "TYPE1" VARCHAR(767), "TYPE2" VARCHAR(767))
No rows affected (0.086 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."GLOBAL_PRIVS" ("USER_GRANT_ID" BIGINT NOT NU LL, "CREATE_TIME" INTEGER NOT NULL, "GRANT_OPTION" SMALLINT NOT NULL, "GRANTOR"  VARCHAR(128), "GRANTOR_TYPE" VARCHAR(128), "PRINCIPAL_NAME" VARCHAR(128), "PRINC IPAL_TYPE" VARCHAR(128), "USER_PRIV" VARCHAR(128))
No rows affected (0.116 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."PARTITION_PARAMS" ("PART_ID" BIGINT NOT NULL , "PARAM_KEY" VARCHAR(256) NOT NULL, "PARAM_VALUE" VARCHAR(4000))
No rows affected (0.108 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."PARTITION_EVENTS" ("PART_NAME_ID" BIGINT NOT  NULL, "DB_NAME" VARCHAR(128), "EVENT_TIME" BIGINT NOT NULL, "EVENT_TYPE" INTEGE R NOT NULL, "PARTITION_NAME" VARCHAR(767), "TBL_NAME" VARCHAR(256))
No rows affected (0.098 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."COLUMNS" ("SD_ID" BIGINT NOT NULL, "COMMENT"  VARCHAR(256), "COLUMN_NAME" VARCHAR(128) NOT NULL, "TYPE_NAME" VARCHAR(4000) NO T NULL, "INTEGER_IDX" INTEGER NOT NULL)
No rows affected (0.102 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."ROLES" ("ROLE_ID" BIGINT NOT NULL, "CREATE_T IME" INTEGER NOT NULL, "OWNER_NAME" VARCHAR(128), "ROLE_NAME" VARCHAR(128))
No rows affected (0.099 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."TBLS" ("TBL_ID" BIGINT NOT NULL, "CREATE_TIM E" INTEGER NOT NULL, "DB_ID" BIGINT, "LAST_ACCESS_TIME" INTEGER NOT NULL, "OWNER " VARCHAR(767), "RETENTION" INTEGER NOT NULL, "SD_ID" BIGINT, "TBL_NAME" VARCHAR (256), "TBL_TYPE" VARCHAR(128), "VIEW_EXPANDED_TEXT" LONG VARCHAR, "VIEW_ORIGINA L_TEXT" LONG VARCHAR, "IS_REWRITE_ENABLED" CHAR(1) NOT NULL)
No rows affected (0.091 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."PARTITION_KEYS" ("TBL_ID" BIGINT NOT NULL, " PKEY_COMMENT" VARCHAR(4000), "PKEY_NAME" VARCHAR(128) NOT NULL, "PKEY_TYPE" VARC HAR(767) NOT NULL, "INTEGER_IDX" INTEGER NOT NULL)
No rows affected (0.087 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."PART_COL_PRIVS" ("PART_COLUMN_GRANT_ID" BIGI NT NOT NULL, "COLUMN_NAME" VARCHAR(767), "CREATE_TIME" INTEGER NOT NULL, "GRANT_ OPTION" SMALLINT NOT NULL, "GRANTOR" VARCHAR(128), "GRANTOR_TYPE" VARCHAR(128),  "PART_ID" BIGINT, "PRINCIPAL_NAME" VARCHAR(128), "PRINCIPAL_TYPE" VARCHAR(128),  "PART_COL_PRIV" VARCHAR(128))
No rows affected (0.096 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."SDS" ("SD_ID" BIGINT NOT NULL, "INPUT_FORMAT " VARCHAR(4000), "IS_COMPRESSED" CHAR(1) NOT NULL, "LOCATION" VARCHAR(4000), "NU M_BUCKETS" INTEGER NOT NULL, "OUTPUT_FORMAT" VARCHAR(4000), "SERDE_ID" BIGINT, " CD_ID" BIGINT, "IS_STOREDASSUBDIRECTORIES" CHAR(1) NOT NULL)
No rows affected (0.102 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."SEQUENCE_TABLE" ("SEQUENCE_NAME" VARCHAR(256 ) NOT NULL, "NEXT_VAL" BIGINT NOT NULL)
No rows affected (0.095 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."TAB_COL_STATS"("DB_NAME" VARCHAR(128) NOT NU LL,"TABLE_NAME" VARCHAR(256) NOT NULL, "COLUMN_NAME" VARCHAR(767) NOT NULL, "COL UMN_TYPE" VARCHAR(128) NOT NULL, "LONG_LOW_VALUE" BIGINT, "LONG_HIGH_VALUE" BIGI NT, "DOUBLE_LOW_VALUE" DOUBLE, "DOUBLE_HIGH_VALUE" DOUBLE, "BIG_DECIMAL_LOW_VALU E" VARCHAR(4000),"BIG_DECIMAL_HIGH_VALUE" VARCHAR(4000),"NUM_DISTINCTS" BIGINT,  "NUM_NULLS" BIGINT NOT NULL, "AVG_COL_LEN" DOUBLE, "MAX_COL_LEN" BIGINT, "NUM_TR UES" BIGINT, "NUM_FALSES" BIGINT, "LAST_ANALYZED" BIGINT, "CS_ID" BIGINT NOT NUL L, "TBL_ID" BIGINT NOT NULL)
No rows affected (0.104 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."TABLE_PARAMS" ("TBL_ID" BIGINT NOT NULL, "PA RAM_KEY" VARCHAR(256) NOT NULL, "PARAM_VALUE" CLOB)
No rows affected (0.102 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."BUCKETING_COLS" ("SD_ID" BIGINT NOT NULL, "B UCKET_COL_NAME" VARCHAR(256), "INTEGER_IDX" INTEGER NOT NULL)
No rows affected (0.087 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."TYPE_FIELDS" ("TYPE_NAME" BIGINT NOT NULL, " COMMENT" VARCHAR(256), "FIELD_NAME" VARCHAR(128) NOT NULL, "FIELD_TYPE" VARCHAR( 767) NOT NULL, "INTEGER_IDX" INTEGER NOT NULL)
No rows affected (0.098 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."NUCLEUS_TABLES" ("CLASS_NAME" VARCHAR(128) N OT NULL, "TABLE_NAME" VARCHAR(128) NOT NULL, "TYPE" VARCHAR(4) NOT NULL, "OWNER"  VARCHAR(2) NOT NULL, "VERSION" VARCHAR(20) NOT NULL, "INTERFACE_NAME" VARCHAR(2 56) DEFAULT NULL)
No rows affected (0.1 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."SD_PARAMS" ("SD_ID" BIGINT NOT NULL, "PARAM_ KEY" VARCHAR(256) NOT NULL, "PARAM_VALUE" CLOB)
0: jdbc:derby:> CRNo rows affected (0.106 seconds)
EATE TABLE "APP"."SKEWED_STRING_LIST" ("STRING_LIST_ID" BIGINT  NOT NULL)
No rows affected (0.103 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."SKEWED_STRING_LIST_VALUES" ("STRING_LIST_ID"  BIGINT NOT NULL, "STRING_LIST_VALUE" VARCHAR(256), "INTEGER_IDX" INTEGER NOT NU LL)
0: jdbc:derby:> CREANo rows affected (0.109 seconds)
TE TABLE "APP"."SKEWED_COL_NAMES" ("SD_ID" BIGINT NOT NULL,  "SKEWED_COL_NAME" VARCHAR(256), "INTEGER_IDX" INTEGER NOT NULL)
No rows affected (0.082 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."SKEWED_COL_VALUE_LOC_MAP" ("SD_ID" BIGINT NO T NULL, "STRING_LIST_ID_KID" BIGINT NOT NULL, "LOCATION" VARCHAR(4000))
No rows affected (0.096 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."SKEWED_VALUES" ("SD_ID_OID" BIGINT NOT NULL,  "STRING_LIST_ID_EID" BIGINT NOT NULL, "INTEGER_IDX" INTEGER NOT NULL)
No rows affected (0.083 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."MASTER_KEYS" ("KEY_ID" INTEGER NOT NULL gene rated always as identity (start with 1), "MASTER_KEY" VARCHAR(767))
No rows affected (0.086 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."DELEGATION_TOKENS" ( "TOKEN_IDENT" VARCHAR(7 67) NOT NULL, "TOKEN" VARCHAR(767))
No rows affected (0.085 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."PART_COL_STATS"("DB_NAME" VARCHAR(128) NOT N ULL,"TABLE_NAME" VARCHAR(256) NOT NULL, "PARTITION_NAME" VARCHAR(767) NOT NULL,  "COLUMN_NAME" VARCHAR(767) NOT NULL, "COLUMN_TYPE" VARCHAR(128) NOT NULL, "LONG_ LOW_VALUE" BIGINT, "LONG_HIGH_VALUE" BIGINT, "DOUBLE_LOW_VALUE" DOUBLE, "DOUBLE_ HIGH_VALUE" DOUBLE, "BIG_DECIMAL_LOW_VALUE" VARCHAR(4000), "BIG_DECIMAL_HIGH_VAL UE" VARCHAR(4000),"NUM_DISTINCTS" BIGINT, "NUM_NULLS" BIGINT NOT NULL, "AVG_COL_ LEN" DOUBLE, "MAX_COL_LEN" BIGINT, "NUM_TRUES" BIGINT, "NUM_FALSES" BIGINT, "LAS T_ANALYZED" BIGINT, "CS_ID" BIGINT NOT NULL, "PART_ID" BIGINT NOT NULL)
No rows affected (0.1 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."VERSION" ("VER_ID" BIGINT NOT NULL, "SCHEMA_ VERSION" VARCHAR(127) NOT NULL, "VERSION_COMMENT" VARCHAR(255))
No rows affected (0.084 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."FUNCS" ("FUNC_ID" BIGINT NOT NULL, "CLASS_NA ME" VARCHAR(4000), "CREATE_TIME" INTEGER NOT NULL, "DB_ID" BIGINT, "FUNC_NAME" V ARCHAR(128), "FUNC_TYPE" INTEGER NOT NULL, "OWNER_NAME" VARCHAR(128), "OWNER_TYP E" VARCHAR(10))
0: jdbc:derby:> CREANo rows affected (0.088 seconds)
TE TABLE "APP"."FUNC_RU" ("FUNC_ID" BIGINT NOT NULL, "RESOUR CE_TYPE" INTEGER NOT NULL, "RESOURCE_URI" VARCHAR(4000), "INTEGER_IDX" INTEGER N OT NULL)
No rows affected (0.089 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."NOTIFICATION_LOG" ("NL_ID" BIGINT NOT NULL,  "DB_NAME" VARCHAR(128), "EVENT_ID" BIGINT NOT NULL, "EVENT_TIME" INTEGER NOT NUL L, "EVENT_TYPE" VARCHAR(32) NOT NULL, "MESSAGE" CLOB, "TBL_NAME" VARCHAR(256), " MESSAGE_FORMAT" VARCHAR(16))
No rows affected (0.088 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."NOTIFICATION_SEQUENCE" ("NNI_ID" BIGINT NOT  NULL, "NEXT_EVENT_ID" BIGINT NOT NULL)
No rows affected (0.086 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."KEY_CONSTRAINTS" ("CHILD_CD_ID" BIGINT, "CHI LD_INTEGER_IDX" INTEGER NOT NULL, "CHILD_TBL_ID" BIGINT, "PARENT_CD_ID" BIGINT N OT NULL, "PARENT_INTEGER_IDX" INTEGER, "PARENT_TBL_ID" BIGINT NOT NULL,  "POSITI ON" BIGINT NOT NULL, "CONSTRAINT_NAME" VARCHAR(400) NOT NULL, "CONSTRAINT_TYPE"  SMALLINT NOT NULL, "UPDATE_RULE" SMALLINT, "DELETE_RULE" SMALLINT, "ENABLE_VALID ATE_RELY" SMALLINT NOT NULL)
No rows affected (0.093 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."KEY_CONSTRAINTS" ADD CONSTRAINT "CONSTRAINTS_ PK" PRIMARY KEY ("CONSTRAINT_NAME", "POSITION")
No rows affected (0.206 seconds)
0: jdbc:derby:> CREATE INDEX "APP"."CONSTRAINTS_PARENT_TBL_ID_INDEX" ON "APP"."K EY_CONSTRAINTS"("PARENT_TBL_ID")
No rows affected (0.158 seconds)
0: jdbc:derby:> CREATE UNIQUE INDEX "APP"."UNIQUEINDEX" ON "APP"."IDXS" ("INDEX_ NAME", "ORIG_TBL_ID")
No rows affected (0.155 seconds)
0: jdbc:derby:> CREATE INDEX "APP"."TABLECOLUMNPRIVILEGEINDEX" ON "APP"."TBL_COL _PRIVS" ("TBL_ID", "COLUMN_NAME", "PRINCIPAL_NAME", "PRINCIPAL_TYPE", "TBL_COL_P RIV", "GRANTOR", "GRANTOR_TYPE")
No rows affected (0.138 seconds)
0: jdbc:derby:> CREATE UNIQUE INDEX "APP"."DBPRIVILEGEINDEX" ON "APP"."DB_PRIVS"  ("DB_ID", "PRINCIPAL_NAME", "PRINCIPAL_TYPE", "DB_PRIV", "GRANTOR", "GRANTOR_TY PE")
No rows affected (0.147 seconds)
0: jdbc:derby:> CREATE INDEX "APP"."PCS_STATS_IDX" ON "APP"."PART_COL_STATS" ("D B_NAME","TABLE_NAME","COLUMN_NAME","PARTITION_NAME")
No rows affected (0.167 seconds)
0: jdbc:derby:> CREATE INDEX "APP"."PARTPRIVILEGEINDEX" ON "APP"."PART_PRIVS" (" PART_ID", "PRINCIPAL_NAME", "PRINCIPAL_TYPE", "PART_PRIV", "GRANTOR", "GRANTOR_T YPE")
No rows affected (0.154 seconds)
0: jdbc:derby:> CREATE UNIQUE INDEX "APP"."ROLEENTITYINDEX" ON "APP"."ROLES" ("R OLE_NAME")
No rows affected (0.155 seconds)
0: jdbc:derby:> CREATE INDEX "APP"."TABLEPRIVILEGEINDEX" ON "APP"."TBL_PRIVS" (" TBL_ID", "PRINCIPAL_NAME", "PRINCIPAL_TYPE", "TBL_PRIV", "GRANTOR", "GRANTOR_TYP E")
No rows affected (0.17 seconds)
0: jdbc:derby:> CREATE UNIQUE INDEX "APP"."UNIQUETABLE" ON "APP"."TBLS" ("TBL_NA ME", "DB_ID")
No rows affected (0.163 seconds)
0: jdbc:derby:> CREATE UNIQUE INDEX "APP"."UNIQUE_DATABASE" ON "APP"."DBS" ("NAM E")
No rows affected (0.136 seconds)
0: jdbc:derby:> CREATE UNIQUE INDEX "APP"."USERROLEMAPINDEX" ON "APP"."ROLE_MAP"  ("PRINCIPAL_NAME", "ROLE_ID", "GRANTOR", "GRANTOR_TYPE")
No rows affected (0.153 seconds)
0: jdbc:derby:> CREATE UNIQUE INDEX "APP"."GLOBALPRIVILEGEINDEX" ON "APP"."GLOBA L_PRIVS" ("PRINCIPAL_NAME", "PRINCIPAL_TYPE", "USER_PRIV", "GRANTOR", "GRANTOR_T YPE")
No rows affected (0.143 seconds)
0: jdbc:derby:> CREATE UNIQUE INDEX "APP"."UNIQUE_TYPE" ON "APP"."TYPES" ("TYPE_ NAME")
No rows affected (0.159 seconds)
0: jdbc:derby:> CREATE INDEX "APP"."PARTITIONCOLUMNPRIVILEGEINDEX" ON "APP"."PAR T_COL_PRIVS" ("PART_ID", "COLUMN_NAME", "PRINCIPAL_NAME", "PRINCIPAL_TYPE", "PAR T_COL_PRIV", "GRANTOR", "GRANTOR_TYPE")
No rows affected (0.142 seconds)
0: jdbc:derby:> CREATE UNIQUE INDEX "APP"."UNIQUEPARTITION" ON "APP"."PARTITIONS " ("PART_NAME", "TBL_ID")
No rows affected (0.162 seconds)
0: jdbc:derby:> CREATE UNIQUE INDEX "APP"."UNIQUEFUNCTION" ON "APP"."FUNCS" ("FU NC_NAME", "DB_ID")
No rows affected (0.157 seconds)
0: jdbc:derby:> CREATE INDEX "APP"."FUNCS_N49" ON "APP"."FUNCS" ("DB_ID")
No rows affected (0.149 seconds)
0: jdbc:derby:> CREATE INDEX "APP"."FUNC_RU_N49" ON "APP"."FUNC_RU" ("FUNC_ID")
No rows affected (0.153 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."IDXS" ADD CONSTRAINT "IDXS_PK" PRIMARY KEY (" INDEX_ID")
0: jdbc:derby:> No rows affected (0.156 seconds)
ALTER TABLE "APP"."TBL_COL_PRIVS" ADD CONSTRAINT "TBL_COL_PRIVS_ PK" PRIMARY KEY ("TBL_COLUMN_GRANT_ID")
No rows affected (0.161 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."CDS" ADD CONSTRAINT "SQL110922153006460" PRIM ARY KEY ("CD_ID")
No rows affected (0.158 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."DB_PRIVS" ADD CONSTRAINT "DB_PRIVS_PK" PRIMAR Y KEY ("DB_GRANT_ID")
No rows affected (0.144 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."INDEX_PARAMS" ADD CONSTRAINT "INDEX_PARAMS_PK " PRIMARY KEY ("INDEX_ID", "PARAM_KEY")
0: jdbc:derby:> No rows affected (0.14 seconds)
ALTER TABLE "APP"."PARTITION_KEYS" ADD CONSTRAINT "PARTITION_KEY _PK" PRIMARY KEY ("TBL_ID", "PKEY_NAME")
No rows affected (0.142 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SEQUENCE_TABLE" ADD CONSTRAINT "SEQUENCE_TABL E_PK" PRIMARY KEY ("SEQUENCE_NAME")
0: jdbc:derby:> No rows affected (0.146 seconds)
ALTER TABLE "APP"."PART_PRIVS" ADD CONSTRAINT "PART_PRIVS_PK" PR IMARY KEY ("PART_GRANT_ID")
No rows affected (0.145 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SDS" ADD CONSTRAINT "SDS_PK" PRIMARY KEY ("SD _ID")
No rows affected (0.137 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SERDES" ADD CONSTRAINT "SERDES_PK" PRIMARY KE Y ("SERDE_ID")
No rows affected (0.178 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."COLUMNS" ADD CONSTRAINT "COLUMNS_PK" PRIMARY  KEY ("SD_ID", "COLUMN_NAME")
No rows affected (0.155 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."PARTITION_EVENTS" ADD CONSTRAINT "PARTITION_E VENTS_PK" PRIMARY KEY ("PART_NAME_ID")
No rows affected (0.144 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."TYPE_FIELDS" ADD CONSTRAINT "TYPE_FIELDS_PK"  PRIMARY KEY ("TYPE_NAME", "FIELD_NAME")
No rows affected (0.143 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."ROLES" ADD CONSTRAINT "ROLES_PK" PRIMARY KEY  ("ROLE_ID")
No rows affected (0.139 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."TBL_PRIVS" ADD CONSTRAINT "TBL_PRIVS_PK" PRIM ARY KEY ("TBL_GRANT_ID")
No rows affected (0.216 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SERDE_PARAMS" ADD CONSTRAINT "SERDE_PARAMS_PK " PRIMARY KEY ("SERDE_ID", "PARAM_KEY")
No rows affected (0.316 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."NUCLEUS_TABLES" ADD CONSTRAINT "NUCLEUS_TABLE S_PK" PRIMARY KEY ("CLASS_NAME")
No rows affected (0.164 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."TBLS" ADD CONSTRAINT "TBLS_PK" PRIMARY KEY (" TBL_ID")
No rows affected (0.148 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SD_PARAMS" ADD CONSTRAINT "SD_PARAMS_PK" PRIM ARY KEY ("SD_ID", "PARAM_KEY")
No rows affected (0.132 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."DATABASE_PARAMS" ADD CONSTRAINT "DATABASE_PAR AMS_PK" PRIMARY KEY ("DB_ID", "PARAM_KEY")
No rows affected (0.189 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."DBS" ADD CONSTRAINT "DBS_PK" PRIMARY KEY ("DB _ID")
0: jdbc:derby:> No rows affected (0.383 seconds)
ALTER TABLE "APP"."ROLE_MAP" ADD CONSTRAINT "ROLE_MAP_PK" PRIMAR Y KEY ("ROLE_GRANT_ID")
No rows affected (0.357 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."GLOBAL_PRIVS" ADD CONSTRAINT "GLOBAL_PRIVS_PK " PRIMARY KEY ("USER_GRANT_ID")
No rows affected (0.305 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."BUCKETING_COLS" ADD CONSTRAINT "BUCKETING_COL S_PK" PRIMARY KEY ("SD_ID", "INTEGER_IDX")
No rows affected (0.427 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SORT_COLS" ADD CONSTRAINT "SORT_COLS_PK" PRIM ARY KEY ("SD_ID", "INTEGER_IDX")
0: jdbc:derby:> No rows affected (0.323 seconds)
ALTER TABLE "APP"."PARTITION_KEY_VALS" ADD CONSTRAINT "PARTITION _KEY_VALS_PK" PRIMARY KEY ("PART_ID", "INTEGER_IDX")
0: jdbc:derby:> No rows affected (0.201 seconds)
ALTER TABLE "APP"."TYPES" ADD CONSTRAINT "TYPES_PK" PRIMARY KEY  ("TYPES_ID")
No rows affected (0.134 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."COLUMNS_V2" ADD CONSTRAINT "SQL11092215300674 0" PRIMARY KEY ("CD_ID", "COLUMN_NAME")
No rows affected (0.144 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."PART_COL_PRIVS" ADD CONSTRAINT "PART_COL_PRIV S_PK" PRIMARY KEY ("PART_COLUMN_GRANT_ID")
No rows affected (0.149 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."PARTITION_PARAMS" ADD CONSTRAINT "PARTITION_P ARAMS_PK" PRIMARY KEY ("PART_ID", "PARAM_KEY")
No rows affected (0.139 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."PARTITIONS" ADD CONSTRAINT "PARTITIONS_PK" PR IMARY KEY ("PART_ID")
No rows affected (0.137 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."TABLE_PARAMS" ADD CONSTRAINT "TABLE_PARAMS_PK " PRIMARY KEY ("TBL_ID", "PARAM_KEY")
No rows affected (0.133 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SKEWED_STRING_LIST" ADD CONSTRAINT "SKEWED_ST RING_LIST_PK" PRIMARY KEY ("STRING_LIST_ID")
No rows affected (0.152 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SKEWED_STRING_LIST_VALUES" ADD CONSTRAINT "SK EWED_STRING_LIST_VALUES_PK" PRIMARY KEY ("STRING_LIST_ID", "INTEGER_IDX")
No rows affected (0.134 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SKEWED_COL_NAMES" ADD CONSTRAINT "SKEWED_COL_ NAMES_PK" PRIMARY KEY ("SD_ID", "INTEGER_IDX")
No rows affected (0.139 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SKEWED_COL_VALUE_LOC_MAP" ADD CONSTRAINT "SKE WED_COL_VALUE_LOC_MAP_PK" PRIMARY KEY ("SD_ID", "STRING_LIST_ID_KID")
No rows affected (0.146 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SKEWED_VALUES" ADD CONSTRAINT "SKEWED_VALUES_ PK" PRIMARY KEY ("SD_ID_OID", "INTEGER_IDX")
No rows affected (0.135 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."TAB_COL_STATS" ADD CONSTRAINT "TAB_COL_STATS_ PK" PRIMARY KEY ("CS_ID")
No rows affected (0.138 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."PART_COL_STATS" ADD CONSTRAINT "PART_COL_STAT S_PK" PRIMARY KEY ("CS_ID")
0: jdbc:derby:> ALTER TNo rows affected (0.148 seconds)
ABLE "APP"."FUNCS" ADD CONSTRAINT "FUNCS_PK" PRIMARY KEY  ("FUNC_ID")
No rows affected (0.135 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."FUNC_RU" ADD CONSTRAINT "FUNC_RU_PK" PRIMARY  KEY ("FUNC_ID", "INTEGER_IDX")
No rows affected (0.138 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."NOTIFICATION_LOG" ADD CONSTRAINT "NOTIFICATIO N_LOG_PK" PRIMARY KEY ("NL_ID")
No rows affected (0.157 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."NOTIFICATION_SEQUENCE" ADD CONSTRAINT "NOTIFI CATION_SEQUENCE_PK" PRIMARY KEY ("NNI_ID")
0: jdbc:derby:> No rows affected (0.156 seconds)
ALTER TABLE "APP"."IDXS" ADD CONSTRAINT "IDXS_FK1" FOREIGN KEY ( "ORIG_TBL_ID") REFERENCES "APP"."TBLS" ("TBL_ID") ON DELETE NO ACTION ON UPDATE  NO ACTION
0: jdbc:derby:> No rows affected (0.204 seconds)
ALTER TABLE "APP"."IDXS" ADD CONSTRAINT "IDXS_FK2" FOREIGN KEY ( "SD_ID") REFERENCES "APP"."SDS" ("SD_ID") ON DELETE NO ACTION ON UPDATE NO ACTIO N
No rows affected (0.169 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."IDXS" ADD CONSTRAINT "IDXS_FK3" FOREIGN KEY ( "INDEX_TBL_ID") REFERENCES "APP"."TBLS" ("TBL_ID") ON DELETE NO ACTION ON UPDATE  NO ACTION
0: jdbc:derby:> No rows affected (0.174 seconds)
ALTER TABLE "APP"."TBL_COL_PRIVS" ADD CONSTRAINT "TBL_COL_PRIVS_ FK1" FOREIGN KEY ("TBL_ID") REFERENCES "APP"."TBLS" ("TBL_ID") ON DELETE NO ACTI ON ON UPDATE NO ACTION
No rows affected (0.159 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."DB_PRIVS" ADD CONSTRAINT "DB_PRIVS_FK1" FOREI GN KEY ("DB_ID") REFERENCES "APP"."DBS" ("DB_ID") ON DELETE NO ACTION ON UPDATE  NO ACTION
No rows affected (0.154 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."INDEX_PARAMS" ADD CONSTRAINT "INDEX_PARAMS_FK 1" FOREIGN KEY ("INDEX_ID") REFERENCES "APP"."IDXS" ("INDEX_ID") ON DELETE NO AC TION ON UPDATE NO ACTION
No rows affected (0.178 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."PARTITION_KEYS" ADD CONSTRAINT "PARTITION_KEY S_FK1" FOREIGN KEY ("TBL_ID") REFERENCES "APP"."TBLS" ("TBL_ID") ON DELETE NO AC TION ON UPDATE NO ACTION
No rows affected (0.173 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."PART_PRIVS" ADD CONSTRAINT "PART_PRIVS_FK1" F OREIGN KEY ("PART_ID") REFERENCES "APP"."PARTITIONS" ("PART_ID") ON DELETE NO AC TION ON UPDATE NO ACTION
No rows affected (0.153 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SDS" ADD CONSTRAINT "SDS_FK1" FOREIGN KEY ("S ERDE_ID") REFERENCES "APP"."SERDES" ("SERDE_ID") ON DELETE NO ACTION ON UPDATE N O ACTION
No rows affected (0.228 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SDS" ADD CONSTRAINT "SDS_FK2" FOREIGN KEY ("C D_ID") REFERENCES "APP"."CDS" ("CD_ID") ON DELETE NO ACTION ON UPDATE NO ACTION
No rows affected (0.152 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."COLUMNS" ADD CONSTRAINT "COLUMNS_FK1" FOREIGN  KEY ("SD_ID") REFERENCES "APP"."SDS" ("SD_ID") ON DELETE NO ACTION ON UPDATE NO  ACTION
No rows affected (0.148 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."TYPE_FIELDS" ADD CONSTRAINT "TYPE_FIELDS_FK1"  FOREIGN KEY ("TYPE_NAME") REFERENCES "APP"."TYPES" ("TYPES_ID") ON DELETE NO AC TION ON UPDATE NO ACTION
No rows affected (0.175 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."TBL_PRIVS" ADD CONSTRAINT "TBL_PRIVS_FK1" FOR EIGN KEY ("TBL_ID") REFERENCES "APP"."TBLS" ("TBL_ID") ON DELETE NO ACTION ON UP DATE NO ACTION
No rows affected (0.145 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SERDE_PARAMS" ADD CONSTRAINT "SERDE_PARAMS_FK 1" FOREIGN KEY ("SERDE_ID") REFERENCES "APP"."SERDES" ("SERDE_ID") ON DELETE NO  ACTION ON UPDATE NO ACTION
No rows affected (0.149 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."TBLS" ADD CONSTRAINT "TBLS_FK2" FOREIGN KEY ( "SD_ID") REFERENCES "APP"."SDS" ("SD_ID") ON DELETE NO ACTION ON UPDATE NO ACTIO N
No rows affected (0.149 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."TBLS" ADD CONSTRAINT "TBLS_FK1" FOREIGN KEY ( "DB_ID") REFERENCES "APP"."DBS" ("DB_ID") ON DELETE NO ACTION ON UPDATE NO ACTIO N
No rows affected (0.151 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SD_PARAMS" ADD CONSTRAINT "SD_PARAMS_FK1" FOR EIGN KEY ("SD_ID") REFERENCES "APP"."SDS" ("SD_ID") ON DELETE NO ACTION ON UPDAT E NO ACTION
No rows affected (0.152 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."DATABASE_PARAMS" ADD CONSTRAINT "DATABASE_PAR AMS_FK1" FOREIGN KEY ("DB_ID") REFERENCES "APP"."DBS" ("DB_ID") ON DELETE NO ACT ION ON UPDATE NO ACTION
No rows affected (0.238 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."ROLE_MAP" ADD CONSTRAINT "ROLE_MAP_FK1" FOREI GN KEY ("ROLE_ID") REFERENCES "APP"."ROLES" ("ROLE_ID") ON DELETE NO ACTION ON U PDATE NO ACTION
No rows affected (0.174 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."BUCKETING_COLS" ADD CONSTRAINT "BUCKETING_COL S_FK1" FOREIGN KEY ("SD_ID") REFERENCES "APP"."SDS" ("SD_ID") ON DELETE NO ACTIO N ON UPDATE NO ACTION
0: jdbc:derby:> No rows affected (0.15 seconds)
ALTER TABLE "APP"."SORT_COLS" ADD CONSTRAINT "SORT_COLS_FK1" FOR EIGN KEY ("SD_ID") REFERENCES "APP"."SDS" ("SD_ID") ON DELETE NO ACTION ON UPDAT E NO ACTION
0: jdbc:derby:> ALNo rows affected (0.145 seconds)
TER TABLE "APP"."PARTITION_KEY_VALS" ADD CONSTRAINT "PARTITION _KEY_VALS_FK1" FOREIGN KEY ("PART_ID") REFERENCES "APP"."PARTITIONS" ("PART_ID")  ON DELETE NO ACTION ON UPDATE NO ACTION
No rows affected (0.149 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."COLUMNS_V2" ADD CONSTRAINT "COLUMNS_V2_FK1" F OREIGN KEY ("CD_ID") REFERENCES "APP"."CDS" ("CD_ID") ON DELETE NO ACTION ON UPD ATE NO ACTION
0: jdbc:derby:> No rows affected (0.226 seconds)
ALTER TABLE "APP"."PART_COL_PRIVS" ADD CONSTRAINT "PART_COL_PRIV S_FK1" FOREIGN KEY ("PART_ID") REFERENCES "APP"."PARTITIONS" ("PART_ID") ON DELE TE NO ACTION ON UPDATE NO ACTION
No rows affected (0.245 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."PARTITION_PARAMS" ADD CONSTRAINT "PARTITION_P ARAMS_FK1" FOREIGN KEY ("PART_ID") REFERENCES "APP"."PARTITIONS" ("PART_ID") ON  DELETE NO ACTION ON UPDATE NO ACTION
0: jdbc:derby:> ALTER TNo rows affected (0.176 seconds)
ABLE "APP"."PARTITIONS" ADD CONSTRAINT "PARTITIONS_FK1" F OREIGN KEY ("TBL_ID") REFERENCES "APP"."TBLS" ("TBL_ID") ON DELETE NO ACTION ON  UPDATE NO ACTION
No rows affected (0.14 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."PARTITIONS" ADD CONSTRAINT "PARTITIONS_FK2" F OREIGN KEY ("SD_ID") REFERENCES "APP"."SDS" ("SD_ID") ON DELETE NO ACTION ON UPD ATE NO ACTION
No rows affected (0.145 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."TABLE_PARAMS" ADD CONSTRAINT "TABLE_PARAMS_FK 1" FOREIGN KEY ("TBL_ID") REFERENCES "APP"."TBLS" ("TBL_ID") ON DELETE NO ACTION  ON UPDATE NO ACTION
No rows affected (0.15 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SKEWED_STRING_LIST_VALUES" ADD CONSTRAINT "SK EWED_STRING_LIST_VALUES_FK1" FOREIGN KEY ("STRING_LIST_ID") REFERENCES "APP"."SK EWED_STRING_LIST" ("STRING_LIST_ID") ON DELETE NO ACTION ON UPDATE NO ACTION
No rows affected (0.14 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SKEWED_COL_NAMES" ADD CONSTRAINT "SKEWED_COL_ NAMES_FK1" FOREIGN KEY ("SD_ID") REFERENCES "APP"."SDS" ("SD_ID") ON DELETE NO A CTION ON UPDATE NO ACTION
0: jdbc:derby:> ALTERNo rows affected (0.141 seconds)
 TABLE "APP"."SKEWED_COL_VALUE_LOC_MAP" ADD CONSTRAINT "SKE WED_COL_VALUE_LOC_MAP_FK1" FOREIGN KEY ("SD_ID") REFERENCES "APP"."SDS" ("SD_ID" ) ON DELETE NO ACTION ON UPDATE NO ACTION
No rows affected (0.136 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SKEWED_COL_VALUE_LOC_MAP" ADD CONSTRAINT "SKE WED_COL_VALUE_LOC_MAP_FK2" FOREIGN KEY ("STRING_LIST_ID_KID") REFERENCES "APP"." SKEWED_STRING_LIST" ("STRING_LIST_ID") ON DELETE NO ACTION ON UPDATE NO ACTION
No rows affected (0.166 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SKEWED_VALUES" ADD CONSTRAINT "SKEWED_VALUES_ FK1" FOREIGN KEY ("SD_ID_OID") REFERENCES "APP"."SDS" ("SD_ID") ON DELETE NO ACT ION ON UPDATE NO ACTION
No rows affected (0.132 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SKEWED_VALUES" ADD CONSTRAINT "SKEWED_VALUES_ FK2" FOREIGN KEY ("STRING_LIST_ID_EID") REFERENCES "APP"."SKEWED_STRING_LIST" (" STRING_LIST_ID") ON DELETE NO ACTION ON UPDATE NO ACTION
No rows affected (0.139 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."TAB_COL_STATS" ADD CONSTRAINT "TAB_COL_STATS_ FK" FOREIGN KEY ("TBL_ID") REFERENCES TBLS("TBL_ID") ON DELETE NO ACTION ON UPDA TE NO ACTION
No rows affected (0.151 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."PART_COL_STATS" ADD CONSTRAINT "PART_COL_STAT S_FK" FOREIGN KEY ("PART_ID") REFERENCES PARTITIONS("PART_ID") ON DELETE NO ACTI ON ON UPDATE NO ACTION
No rows affected (0.14 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."VERSION" ADD CONSTRAINT "VERSION_PK" PRIMARY  KEY ("VER_ID")
No rows affected (0.143 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."FUNCS" ADD CONSTRAINT "FUNCS_FK1" FOREIGN KEY  ("DB_ID") REFERENCES "APP"."DBS" ("DB_ID") ON DELETE NO ACTION ON UPDATE NO ACT ION
No rows affected (0.021 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."FUNC_RU" ADD CONSTRAINT "FUNC_RU_FK1" FOREIGN  KEY ("FUNC_ID") REFERENCES "APP"."FUNCS" ("FUNC_ID") ON DELETE NO ACTION ON UPD ATE NO ACTION
No rows affected (0.028 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."IDXS" ADD CONSTRAINT "SQL110318025504980" CHE CK (DEFERRED_REBUILD IN ('Y','N'))
No rows affected (0.036 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SDS" ADD CONSTRAINT "SQL110318025505550" CHEC K (IS_COMPRESSED IN ('Y','N'))
No rows affected (0.019 seconds)
0: jdbc:derby:> CREATE TABLE TXNS ( TXN_ID bigint PRIMARY KEY, TXN_STATE char(1)  NOT NULL, TXN_STARTED bigint NOT NULL, TXN_LAST_HEARTBEAT bigint NOT NULL, TXN_ USER varchar(128) NOT NULL, TXN_HOST varchar(128) NOT NULL, TXN_AGENT_INFO varch ar(128), TXN_META_INFO varchar(128), TXN_HEARTBEAT_COUNT integer )
No rows affected (0.22 seconds)
0: jdbc:derby:> CREATE TABLE TXN_COMPONENTS ( TC_TXNID bigint REFERENCES TXNS (T XN_ID), TC_DATABASE varchar(128) NOT NULL, TC_TABLE varchar(128), TC_PARTITION v archar(767), TC_OPERATION_TYPE char(1) NOT NULL )
0: jdbc:derby:> No rows affected (0.416 seconds)
CREATE INDEX TC_TXNID_INDEX ON TXN_COMPONENTS (TC_TXNID)
No rows affected (0.005 seconds)
0: jdbc:derby:> CREATE TABLE COMPLETED_TXN_COMPONENTS ( CTC_TXNID bigint, CTC_DA TABASE varchar(128) NOT NULL, CTC_TABLE varchar(256), CTC_PARTITION varchar(767)  )
No rows affected (0.088 seconds)
0: jdbc:derby:> CREATE TABLE NEXT_TXN_ID ( NTXN_NEXT bigint NOT NULL )
No rows affected (0.121 seconds)
0: jdbc:derby:> INSERT INTO NEXT_TXN_ID VALUES(1)
1 row affected (0.121 seconds)
0: jdbc:derby:> CREATE TABLE HIVE_LOCKS ( HL_LOCK_EXT_ID bigint NOT NULL, HL_LOC K_INT_ID bigint NOT NULL, HL_TXNID bigint, HL_DB varchar(128) NOT NULL, HL_TABLE  varchar(128), HL_PARTITION varchar(767), HL_LOCK_STATE char(1) NOT NULL, HL_LOC K_TYPE char(1) NOT NULL, HL_LAST_HEARTBEAT bigint NOT NULL, HL_ACQUIRED_AT bigin t, HL_USER varchar(128) NOT NULL, HL_HOST varchar(128) NOT NULL, HL_HEARTBEAT_CO UNT integer, HL_AGENT_INFO varchar(128), HL_BLOCKEDBY_EXT_ID bigint, HL_BLOCKEDB Y_INT_ID bigint, PRIMARY KEY(HL_LOCK_EXT_ID, HL_LOCK_INT_ID) )
No rows affected (0.202 seconds)
0: jdbc:derby:> CREATE INDEX HL_TXNID_INDEX ON HIVE_LOCKS (HL_TXNID)
No rows affected (0.136 seconds)
0: jdbc:derby:> CREATE TABLE NEXT_LOCK_ID ( NL_NEXT bigint NOT NULL )
No rows affected (0.088 seconds)
0: jdbc:derby:> INSERT INTO NEXT_LOCK_ID VALUES(1)
1 row affected (0.02 seconds)
0: jdbc:derby:> CREATE TABLE COMPACTION_QUEUE ( CQ_ID bigint PRIMARY KEY, CQ_DAT ABASE varchar(128) NOT NULL, CQ_TABLE varchar(128) NOT NULL, CQ_PARTITION varcha r(767), CQ_STATE char(1) NOT NULL, CQ_TYPE char(1) NOT NULL, CQ_TBLPROPERTIES va rchar(2048), CQ_WORKER_ID varchar(128), CQ_START bigint, CQ_RUN_AS varchar(128),  CQ_HIGHEST_TXN_ID bigint, CQ_META_INFO varchar(2048) for bit data, CQ_HADOOP_JO B_ID varchar(32) )
0: jdbc:derby:> No rows affected (0.21 seconds)
CREATE TABLE NEXT_COMPACTION_QUEUE_ID ( NCQ_NEXT bigint NOT NULL  )
No rows affected (0.081 seconds)
0: jdbc:derby:> INSERT INTO NEXT_COMPACTION_QUEUE_ID VALUES(1)
1 row affected (0.028 seconds)
0: jdbc:derby:> CREATE TABLE COMPLETED_COMPACTIONS ( CC_ID bigint PRIMARY KEY, C C_DATABASE varchar(128) NOT NULL, CC_TABLE varchar(128) NOT NULL, CC_PARTITION v archar(767), CC_STATE char(1) NOT NULL, CC_TYPE char(1) NOT NULL, CC_TBLPROPERTI ES varchar(2048), CC_WORKER_ID varchar(128), CC_START bigint, CC_END bigint, CC_ RUN_AS varchar(128), CC_HIGHEST_TXN_ID bigint, CC_META_INFO varchar(2048) for bi t data, CC_HADOOP_JOB_ID varchar(32) )
No rows affected (0.223 seconds)
0: jdbc:derby:> CREATE TABLE AUX_TABLE ( MT_KEY1 varchar(128) NOT NULL, MT_KEY2  bigint NOT NULL, MT_COMMENT varchar(255), PRIMARY KEY(MT_KEY1, MT_KEY2) )
0: jdbc:derby:> No rows affected (0.209 seconds)
CREATE TABLE WRITE_SET ( WS_DATABASE varchar(128) NOT NULL, WS_T ABLE varchar(128) NOT NULL, WS_PARTITION varchar(767), WS_TXNID bigint NOT NULL,  WS_COMMIT_ID bigint NOT NULL, WS_OPERATION_TYPE char(1) NOT NULL )
0: jdbc:derby:> INNo rows affected (0.079 seconds)
SERT INTO "APP"."VERSION" (VER_ID, SCHEMA_VERSION, VERSION_COM MENT) VALUES (1, '2.3.0', 'Hive release version 2.3.0')
0: jdbc:derby:> 1 row affected (0.025 seconds)
!closeall
Closing: 0: jdbc:derby:;databaseName=/hive/data/metastore_db;create=true
beeline> 
beeline> Initialization script completed
schemaTool completed
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/hive/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/hadoop/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in file:/hive/conf/hive-log4j2.properties Async: true
OK
Time taken: 21.375 seconds
Loading data to table default.table2
OK
Time taken: 2.402 seconds
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/hive/lib/log4j-slf4j-impl-2.10.0.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/hadoop/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Metastore connection URL:	 jdbc:derby:;databaseName=/hive/data/metastore_db;create=true
Metastore Connection Driver :	 org.apache.derby.jdbc.EmbeddedDriver
Metastore connection User:	 APP
Starting upgrade metastore schema from version 2.3.0 to 3.0.0
Upgrade script upgrade-2.3.0-to-3.0.0.derby.sql
Connecting to jdbc:derby:;databaseName=/hive/data/metastore_db;create=true
Connected to: Apache Derby (version 10.14.1.0 - (1808820))
Driver: Apache Derby Embedded JDBC Driver (version 10.14.1.0 - (1808820))
Transaction isolation: TRANSACTION_READ_COMMITTED
0: jdbc:derby:> !autocommit on
Autocommit status: true
0: jdbc:derby:> CREATE TABLE "APP"."METASTORE_DB_PROPERTIES" ("PROPERTY_KEY" VAR CHAR(255) NOT NULL, "PROPERTY_VALUE" VARCHAR(1000) NOT NULL, "DESCRIPTION" VARCH AR(1000))
No rows affected (0.17 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."METASTORE_DB_PROPERTIES" ADD CONSTRAINT "PROP ERTY_KEY_PK" PRIMARY KEY ("PROPERTY_KEY")
No rows affected (0.226 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."KEY_CONSTRAINTS" ALTER COLUMN "CHILD_INTEGER_ IDX" NULL
No rows affected (0.06 seconds)
0: jdbc:derby:> CREATE INDEX "APP"."CONSTRAINTS_CONSTRAINT_TYPE_INDEX" ON "APP". "KEY_CONSTRAINTS"("CONSTRAINT_TYPE")
No rows affected (0.164 seconds)
0: jdbc:derby:> UPDATE SERDE_PARAMS SET PARAM_KEY='collection.delim' WHERE PARAM _KEY='colelction.delim'
No rows affected (0.116 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."PART_COL_STATS" ADD COLUMN "BIT_VECTOR" BLOB
No rows affected (0.04 seconds)
0: jdbc:derby:> INSERT INTO "APP"."NOTIFICATION_SEQUENCE" ("NNI_ID", "NEXT_EVENT _ID") SELECT * FROM (VALUES (1,1)) tmp_table WHERE NOT EXISTS ( SELECT "NEXT_EVE NT_ID" FROM "APP"."NOTIFICATION_SEQUENCE")
1 row affected (0.076 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."WM_RESOURCEPLAN" (RP_ID BIGINT NOT NULL, NAM E VARCHAR(128) NOT NULL, QUERY_PARALLELISM INTEGER, STATUS VARCHAR(20) NOT NULL,  DEFAULT_POOL_ID BIGINT)
No rows affected (0.089 seconds)
0: jdbc:derby:> CREATE UNIQUE INDEX "APP"."UNIQUE_WM_RESOURCEPLAN" ON "APP"."WM_ RESOURCEPLAN" ("NAME")
No rows affected (0.148 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."WM_RESOURCEPLAN" ADD CONSTRAINT "WM_RESOURCEP LAN_PK" PRIMARY KEY ("RP_ID")
No rows affected (0.184 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."WM_POOL" (POOL_ID BIGINT NOT NULL, RP_ID BIG INT NOT NULL, PATH VARCHAR(1024) NOT NULL, ALLOC_FRACTION DOUBLE, QUERY_PARALLEL ISM INTEGER, SCHEDULING_POLICY VARCHAR(1024))
No rows affected (0.103 seconds)
0: jdbc:derby:> CREATE UNIQUE INDEX "APP"."UNIQUE_WM_POOL" ON "APP"."WM_POOL" (" RP_ID", "PATH")
No rows affected (0.161 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."WM_POOL" ADD CONSTRAINT "WM_POOL_PK" PRIMARY  KEY ("POOL_ID")
No rows affected (0.173 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."WM_POOL" ADD CONSTRAINT "WM_POOL_FK1" FOREIGN  KEY ("RP_ID") REFERENCES "APP"."WM_RESOURCEPLAN" ("RP_ID") ON DELETE NO ACTION  ON UPDATE NO ACTION
No rows affected (0.192 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."WM_RESOURCEPLAN" ADD CONSTRAINT "WM_RESOURCEP LAN_FK1" FOREIGN KEY ("DEFAULT_POOL_ID") REFERENCES "APP"."WM_POOL" ("POOL_ID")  ON DELETE NO ACTION ON UPDATE NO ACTION
No rows affected (0.179 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."WM_TRIGGER" (TRIGGER_ID BIGINT NOT NULL, RP_ ID BIGINT NOT NULL, NAME VARCHAR(128) NOT NULL, TRIGGER_EXPRESSION VARCHAR(1024) , ACTION_EXPRESSION VARCHAR(1024), IS_IN_UNMANAGED INTEGER NOT NULL DEFAULT 0)
No rows affected (0.111 seconds)
0: jdbc:derby:> CREATE UNIQUE INDEX "APP"."UNIQUE_WM_TRIGGER" ON "APP"."WM_TRIGG ER" ("RP_ID", "NAME")
No rows affected (0.167 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."WM_TRIGGER" ADD CONSTRAINT "WM_TRIGGER_PK" PR IMARY KEY ("TRIGGER_ID")
No rows affected (0.181 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."WM_TRIGGER" ADD CONSTRAINT "WM_TRIGGER_FK1" F OREIGN KEY ("RP_ID") REFERENCES "APP"."WM_RESOURCEPLAN" ("RP_ID") ON DELETE NO A CTION ON UPDATE NO ACTION
No rows affected (0.178 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."WM_POOL_TO_TRIGGER"  (POOL_ID BIGINT NOT NUL L, TRIGGER_ID BIGINT NOT NULL)
No rows affected (0.09 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."WM_POOL_TO_TRIGGER" ADD CONSTRAINT "WM_POOL_T O_TRIGGER_PK" PRIMARY KEY ("POOL_ID", "TRIGGER_ID")
No rows affected (0.147 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."WM_POOL_TO_TRIGGER" ADD CONSTRAINT "WM_POOL_T O_TRIGGER_FK1" FOREIGN KEY ("POOL_ID") REFERENCES "APP"."WM_POOL" ("POOL_ID") ON  DELETE NO ACTION ON UPDATE NO ACTION
No rows affected (0.17 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."WM_POOL_TO_TRIGGER" ADD CONSTRAINT "WM_POOL_T O_TRIGGER_FK2" FOREIGN KEY ("TRIGGER_ID") REFERENCES "APP"."WM_TRIGGER" ("TRIGGE R_ID") ON DELETE NO ACTION ON UPDATE NO ACTION
No rows affected (0.174 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."WM_MAPPING" (MAPPING_ID BIGINT NOT NULL, RP_ ID BIGINT NOT NULL, ENTITY_TYPE VARCHAR(128) NOT NULL, ENTITY_NAME VARCHAR(128)  NOT NULL, POOL_ID BIGINT, ORDERING INTEGER)
No rows affected (0.077 seconds)
0: jdbc:derby:> CREATE UNIQUE INDEX "APP"."UNIQUE_WM_MAPPING" ON "APP"."WM_MAPPI NG" ("RP_ID", "ENTITY_TYPE", "ENTITY_NAME")
No rows affected (0.148 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."WM_MAPPING" ADD CONSTRAINT "WM_MAPPING_PK" PR IMARY KEY ("MAPPING_ID")
No rows affected (0.161 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."WM_MAPPING" ADD CONSTRAINT "WM_MAPPING_FK1" F OREIGN KEY ("RP_ID") REFERENCES "APP"."WM_RESOURCEPLAN" ("RP_ID") ON DELETE NO A CTION ON UPDATE NO ACTION
No rows affected (0.176 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."WM_MAPPING" ADD CONSTRAINT "WM_MAPPING_FK2" F OREIGN KEY ("POOL_ID") REFERENCES "APP"."WM_POOL" ("POOL_ID") ON DELETE NO ACTIO N ON UPDATE NO ACTION
No rows affected (0.161 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SERDES" ADD COLUMN "DESCRIPTION" VARCHAR(4000 )
No rows affected (0.021 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SERDES" ADD COLUMN "SERIALIZER_CLASS" VARCHAR (4000)
No rows affected (0.034 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SERDES" ADD COLUMN "DESERIALIZER_CLASS" VARCH AR(4000)
No rows affected (0.024 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."SERDES" ADD COLUMN "SERDE_TYPE" INTEGER
No rows affected (0.02 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."I_SCHEMA" ( "SCHEMA_ID" bigint primary key,  "SCHEMA_TYPE" integer not null, "NAME" varchar(256) unique, "DB_ID" bigint refer ences "APP"."DBS" ("DB_ID"), "COMPATIBILITY" integer not null, "VALIDATION_LEVEL " integer not null, "CAN_EVOLVE" char(1) not null, "SCHEMA_GROUP" varchar(256),  "DESCRIPTION" varchar(4000) )
No rows affected (0.741 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."SCHEMA_VERSION" ( "SCHEMA_VERSION_ID" bigint  primary key, "SCHEMA_ID" bigint references "APP"."I_SCHEMA" ("SCHEMA_ID"), "VER SION" integer not null, "CREATED_AT" bigint not null, "CD_ID" bigint references  "APP"."CDS" ("CD_ID"), "STATE" integer not null, "DESCRIPTION" varchar(4000), "S CHEMA_TEXT" clob, "FINGERPRINT" varchar(256), "SCHEMA_VERSION_NAME" varchar(256) , "SERDE_ID" bigint references "APP"."SERDES" ("SERDE_ID") )
No rows affected (0.698 seconds)
0: jdbc:derby:> CREATE UNIQUE INDEX "APP"."UNIQUE_SCHEMA_VERSION" ON "APP"."SCHE MA_VERSION" ("SCHEMA_ID", "VERSION")
No rows affected (0.164 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."MV_CREATION_METADATA" ( "MV_CREATION_METADAT A_ID" BIGINT NOT NULL, "CAT_NAME" VARCHAR(256) NOT NULL, "DB_NAME" VARCHAR(128)  NOT NULL, "TBL_NAME" VARCHAR(256) NOT NULL, "TXN_LIST" CLOB )
No rows affected (0.093 seconds)
0: jdbc:derby:> CREATE TABLE "APP"."MV_TABLES_USED" ( "MV_CREATION_METADATA_ID"  BIGINT NOT NULL, "TBL_ID" BIGINT NOT NULL )
No rows affected (0.073 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."MV_CREATION_METADATA" ADD CONSTRAINT "MV_CREA TION_METADATA_PK" PRIMARY KEY ("MV_CREATION_METADATA_ID")
No rows affected (0.166 seconds)
0: jdbc:derby:> CREATE UNIQUE INDEX "APP"."MV_UNIQUE_TABLE" ON "APP"."MV_CREATIO N_METADATA" ("TBL_NAME", "DB_NAME")
No rows affected (0.151 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."MV_TABLES_USED" ADD CONSTRAINT "MV_TABLES_USE D_FK1" FOREIGN KEY ("MV_CREATION_METADATA_ID") REFERENCES "APP"."MV_CREATION_MET ADATA" ("MV_CREATION_METADATA_ID") ON DELETE NO ACTION ON UPDATE NO ACTION
No rows affected (0.165 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."MV_TABLES_USED" ADD CONSTRAINT "MV_TABLES_USE D_FK2" FOREIGN KEY ("TBL_ID") REFERENCES "APP"."TBLS" ("TBL_ID") ON DELETE NO AC TION ON UPDATE NO ACTION
No rows affected (0.164 seconds)
0: jdbc:derby:> ALTER TABLE "APP"."COMPLETED_TXN_COMPONENTS" ADD "CTC_TIMESTAMP"  timestamp
No rows affected (0.022 seconds)
0: jdbc:derby:> UPDATE "APP"."TBLS" SET "IS_REWRITE_ENABLED" = CURRENT_TIMESTAMP 
Error: A truncation error was encountered trying to shrink CHAR '2021-08-24 14:56:21.239' to length 1. (state=22001,code=30000)
Closing: 0: jdbc:derby:;databaseName=/hive/data/metastore_db;create=true
org.apache.hadoop.hive.metastore.HiveMetaException: Upgrade FAILED! Metastore state would be inconsistent !!
Underlying cause: java.io.IOException : Schema script failed, errorcode 2
org.apache.hadoop.hive.metastore.HiveMetaException: Upgrade FAILED! Metastore state would be inconsistent !!
	at org.apache.hive.beeline.HiveSchemaTool.doUpgrade(HiveSchemaTool.java:548)
	at org.apache.hive.beeline.HiveSchemaTool.doUpgrade(HiveSchemaTool.java:512)
	at org.apache.hive.beeline.HiveSchemaTool.main(HiveSchemaTool.java:1440)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.util.RunJar.run(RunJar.java:239)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:153)
Caused by: java.io.IOException: Schema script failed, errorcode 2
	at org.apache.hive.beeline.HiveSchemaTool.runBeeLine(HiveSchemaTool.java:1165)
	at org.apache.hive.beeline.HiveSchemaTool.runBeeLine(HiveSchemaTool.java:1143)
	at org.apache.hive.beeline.HiveSchemaTool.doUpgrade(HiveSchemaTool.java:543)
	... 8 more
*** schemaTool failed ***
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/hive/lib/log4j-slf4j-impl-2.10.0.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/hadoop/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/hive/lib/log4j-slf4j-impl-2.10.0.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/hadoop/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Hive Session ID = 33c4ea2e-e3b4-4656-b42b-e0d0084069a2

Logging initialized using configuration in file:/hive/conf/hive-log4j2.properties Async: true
Exception in thread "main" java.lang.RuntimeException: java.net.ConnectException: Call From 10c93e6e0549/252.18.1.3 to DC3N1:9000 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:644)
	at org.apache.hadoop.hive.ql.session.SessionState.beginStart(SessionState.java:585)
	at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:747)
	at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:683)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.util.RunJar.run(RunJar.java:239)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:153)
Caused by: java.net.ConnectException: Call From 10c93e6e0549/252.18.1.3 to DC3N1:9000 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:824)
	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:754)
	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1497)
	at org.apache.hadoop.ipc.Client.call(Client.java:1439)
	at org.apache.hadoop.ipc.Client.call(Client.java:1349)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:227)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:116)
	at com.sun.proxy.$Proxy29.getFileInfo(Unknown Source)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.getFileInfo(ClientNamenodeProtocolTranslatorPB.java:796)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:422)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeMethod(RetryInvocationHandler.java:165)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invoke(RetryInvocationHandler.java:157)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeOnce(RetryInvocationHandler.java:95)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:359)
	at com.sun.proxy.$Proxy30.getFileInfo(Unknown Source)
	at org.apache.hadoop.hdfs.DFSClient.getFileInfo(DFSClient.java:1717)
	at org.apache.hadoop.hdfs.DistributedFileSystem$29.doCall(DistributedFileSystem.java:1526)
	at org.apache.hadoop.hdfs.DistributedFileSystem$29.doCall(DistributedFileSystem.java:1523)
	at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)
	at org.apache.hadoop.hdfs.DistributedFileSystem.getFileStatus(DistributedFileSystem.java:1538)
	at org.apache.hadoop.fs.FileSystem.exists(FileSystem.java:1627)
	at org.apache.hadoop.hive.ql.exec.Utilities.ensurePathIsWritable(Utilities.java:4483)
	at org.apache.hadoop.hive.ql.session.SessionState.createRootHDFSDir(SessionState.java:753)
	at org.apache.hadoop.hive.ql.session.SessionState.createSessionDirs(SessionState.java:694)
	at org.apache.hadoop.hive.ql.session.SessionState.start(SessionState.java:620)
	... 9 more
Caused by: java.net.ConnectException: Connection refused
	at sun.nio.ch.SocketChannelImpl.checkConnect(Native Method)
	at sun.nio.ch.SocketChannelImpl.finishConnect(SocketChannelImpl.java:716)
	at org.apache.hadoop.net.SocketIOWithTimeout.connect(SocketIOWithTimeout.java:206)
	at org.apache.hadoop.net.NetUtils.connect(NetUtils.java:531)
	at org.apache.hadoop.ipc.Client$Connection.setupConnection(Client.java:687)
	at org.apache.hadoop.ipc.Client$Connection.setupIOstreams(Client.java:790)
	at org.apache.hadoop.ipc.Client$Connection.access$3500(Client.java:411)
	at org.apache.hadoop.ipc.Client.getConnection(Client.java:1554)
	at org.apache.hadoop.ipc.Client.call(Client.java:1385)
	... 34 more
